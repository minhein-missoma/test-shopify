{% assign item_width_classes = 'w-full' %}
{% assign block_count = section.blocks | size %}
{% if block_count > 1 %}
   {% assign item_width_classes = item_width_classes | append: ' md:w-1/2' %}
{% endif %}
{% if block_count == 3 or block_count > 4 %}
   {% assign item_width_classes = item_width_classes | append: ' lg:w-1/3' %}
{% endif %}

{% if block_count > 0 %}
   <div class="vertical-spacing-sm">
      <div class="container">
         <div class="flex -mx-4 gap-y-12 flex-wrap">
            {% for block in section.blocks %}
               {% render 'block-cta-repeater-item',
                  cta: block.settings,
                  item_width_classes: item_width_classes,
                  cta_colour: section.settings.cta_colour
               %}
            {% endfor %}
         </div>
      </div>
   </div>
{% endif %}

{% schema %}
{
   "name": "Block Cta Repeater",
   "settings": [
      {
         "type": "header",
         "content": "Content"
      },
      {
         "type": "select",
         "id": "cta_colour",
         "label": "CTA Colour",
         "options": [
            {
               "value": "button-aqua",
               "label": "Aqua"
            },
            {
               "value": "button-black",
               "label": "Black"
            }
         ],
         "default": "button-black"
      },
   ],
   "max_blocks": 3,
   "blocks": [
      {
         "type": "cta",
         "name": "CTA",
         "settings": [
            {
               "type": "header",
               "content": "CTA"
            },
            {
               "type": "url",
               "id": "cta_link",
               "label": "CTA Link"
            },
            {
               "type": "text",
               "id": "cta_text",
               "label": "CTA Text"
            },
            {
               "type": "checkbox",
               "id": "cta_target",
               "label": "Open in new tab?",
               "default": false
            },
            {
               "type": "header",
               "content": "Content"
            },
            {
               "type": "image_picker",
               "id": "icon",
               "label": "Icon"
            },
            {
               "type": "text",
               "id": "heading",
               "label": "Block Heading"
            },
            {
               "type": "textarea",
               "id": "blurb",
               "label": "Block text"
            }
         ]
      }
   ],
   "presets": [{
      "name": "Block Cta Repeater",
      "blocks": []
   }]
}
{% endschema %}